{% extends "base.html" %} {% block content %}
<div class="container mt-4">
  <div class="card p-4 mb-4 shadow-sm" style="border-radius: 10px">
    <h2>Welcome, {{ current_user.username }}</h2>
    <p class="text-muted">
      Here you can view and manage your submitted papers.
    </p>
  </div>

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>My Papers</h3>
    <div>
      <a href="{{ url_for('publisher.submit_paper') }}" class="btn btn-primary"
        >Submit New Paper</a
      >

      {% if current_user.role == 'Publisher' %}
      <a
        href="{{ url_for('publisher.request_upgrade') }}"
        class="btn btn-outline-warning ms-2"
        >Become Recommender</a
      >
      {% endif %}
    </div>
  </div>

  <div class="card p-3 shadow-sm" style="border-radius: 10px">
    <table class="table table-striped mb-0 table-hover">
      <thead class="table-dark">
        <tr>
          <th>Title</th>
          <th>Abstract</th>
          <th>Status</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody>
        {% for paper in papers %}
        <tr>
          <td>{{ paper.title }}</td>
          <td>{{ paper.abstract | truncate(50) }}</td>
          <td>
            {% if paper.status == 'Accepted' %}
            <span class="badge bg-success">Accepted</span>
            {% elif paper.status == 'Rejected' %}
            <span class="badge bg-danger">Rejected</span>
            {% else %}
            <span class="badge bg-warning text-dark">Pending</span>
            {% endif %}
          </td>
          <td>
            {{ paper.submitted_at.strftime('%Y-%m-%d') if paper.submitted_at
            else 'N/A' }}
          </td>
          <td>
            {% if paper.status == 'Accepted' %}
            <span class="badge bg-success">Accepted</span>
            {% elif paper.status == 'Rejected' %}
            <span class="badge bg-danger">Rejected</span>
            <br />
            <small class="text-danger">Reason: {{ paper.feedback }}</small> {%
            else %}
            <span class="badge bg-warning text-dark">Pending</span>
            {% endif %}
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="4" class="text-center py-3">No papers submitted yet.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
